# 레포 전체 할 일 (Overall Repository Tasks)

**최종 업데이트**: 2025-01-15  
**프로젝트 상태**: 약 98% 완료

---

## 📊 현재 상태 요약

### ✅ 완료된 주요 작업

- Contact Log 기능 구현 및 개선 (배치 조회, 편집 기능 확장)
- 성능 최적화 (가상화, 데이터 페칭 통일)
- 에러 처리 가이드라인 구현
- 반응형 디자인 완료
- 타입 안정성 개선

### 📈 통계

- **테스트 커버리지**: 51.04% (목표: 70%+)
- **TODO/FIXME 주석**: 746개 (141개 파일)
- **`any` 타입 사용**: 31개 (10개 파일)
- **테스트 파일**: 141개 (96개 .test.tsx, 45개 .test.ts)

---

## 🔴 Critical (프로덕션 전 필수)

### 1. 인증/인가 강화 ⚠️ **최우선**

**예상 시간**: 3-5일  
**중요도**: ⭐⭐⭐⭐⭐

**작업 내용**:

- [ ] RLS (Row Level Security) 정책 검토 및 강화
- [ ] API 라우트 인증 미들웨어 추가
- [ ] 세션 관리 개선
- [ ] 권한 기반 접근 제어 구현
- [ ] API 엔드포인트별 권한 검증

**위치**:

- `src/app/api/**/route.ts` (모든 API 라우트)
- `supabase/migrations/**/*.sql` (RLS 정책)

---

## 🟠 High Priority (우선 처리)

### 2. 기능 중복 해결 ✅ 완료

**예상 시간**: 2-3일 (실제: 완료)  
**중요도**: ⭐⭐⭐⭐

**작업 내용**:

- [x] Dashboard vs Instruments 명확한 차별화 또는 통합
  - ✅ `/dashboard` (Items): 악기 재고 관리 및 전체 현황 (모든 악기 관리 기능 제공)
  - ✅ `/instruments`: 제거됨 (Dashboard로 통합)
- [x] 각 페이지의 목적 명확히 정의
- [x] Clients 관련 페이지 통합 고려
  - `/clients`: 기본 정보 관리 (유지 - 명확한 목적)
  - `/connections`: 클라이언트-악기 연결 (유지 - 명확한 목적)
  - 각각 명확한 목적이 있어 통합 불필요

**위치**:

- `src/app/dashboard/page.tsx` (모든 악기 관리 기능 제공)

---

### 3. 테스트 커버리지 향상

**예상 시간**: 1-2주  
**중요도**: ⭐⭐⭐⭐

**현재**: 51.04% (Statements)  
**목표**: 70%+

**우선순위 테스트 추가**:

- [ ] `GroupedTaskList.tsx` - 0% 커버리지 (테스트 없음)
- [ ] `CalendarView.tsx` - 50% → 80%+
- [ ] `calendar/page.tsx` - 63.41% → 80%+
- [ ] API 라우트 테스트 확대
- [ ] 에러 핸들링 경로 테스트

**위치**:

- `src/app/calendar/components/GroupedTaskList.tsx`
- `src/app/calendar/components/CalendarView.tsx`
- `src/app/calendar/page.tsx`
- `src/app/api/**/route.ts`

---

### 4. 타입 안정성 개선

**예상 시간**: 3-5일  
**중요도**: ⭐⭐⭐⭐

**작업 내용**:

- [ ] `any` 타입 제거 (현재 31개)
- [ ] 타입 정의 강화
- [ ] 타입 가드 추가

**위치**:

- `src/hooks/useUnifiedData.ts` (8개)
- `src/app/clients/__tests__/ClientsPage.test.tsx` (6개)
- `src/app/connections/__tests__/page.test.tsx` (6개)
- 기타 7개 파일

---

## 🟡 Medium Priority

### 5. UX 개선 (Quick Wins)

**예상 시간**: 1-2일  
**중요도**: ⭐⭐⭐

**작업 내용**:

- [ ] 로그인 페이지 "LATEST" 제거
- [ ] 빈 상태 처리 일관성 개선
- [ ] 에러 메시지 표시 방식 통일 (대부분 완료)

**위치**:

- `src/app/login/page.tsx`
- `src/components/common/EmptyState.tsx` (또는 유사 컴포넌트)

---

### 6. Contact Log 기능 확장

**예상 시간**: 2-3일  
**중요도**: ⭐⭐⭐

**작업 내용**:

- [ ] Contact log 검색/필터링 기능 추가
  - 타입별 필터
  - 목적별 필터
  - 날짜 범위 필터
- [ ] Contact log 통계/분석 기능 추가
  - 연락 빈도 통계
  - 타입별 통계
  - 클라이언트별 연락 이력 분석

**위치**:

- `src/app/clients/components/ContactLog.tsx`
- `src/app/api/contacts/route.ts`

---

### 7. 성능 최적화

**예상 시간**: 2-4일  
**중요도**: ⭐⭐⭐

**작업 내용**:

- [ ] Clients 리스트 가상화 활성화 (현재 비활성화)
- [ ] O(n²) 복잡도 개선 (Map 기반 조회)
- [ ] 추가 컴포넌트 메모이제이션 (5-10개)
- [ ] Context 세분화 (불필요한 리렌더링 방지)

**위치**:

- `src/app/clients/components/ClientList.tsx`
- `src/hooks/useUnifiedData.ts`
- `src/contexts/DataContext.tsx`

---

### 8. SaleForm 개선

**예상 시간**: 1-2시간  
**중요도**: ⭐⭐⭐

**작업 내용**:

- [ ] 최근 거래한 클라이언트 우선 표시
- [ ] 판매 기록 기반 클라이언트 추천

**위치**:

- `src/app/sales/components/SaleForm.tsx:45`

---

## 🟢 Low Priority

### 9. 문서화 개선

**예상 시간**: 3-4일  
**중요도**: ⭐⭐

**작업 내용**:

- [ ] API 문서화 (OpenAPI/Swagger)
- [ ] 컴포넌트 JSDoc 주석 추가
- [ ] 아키텍처 다이어그램 업데이트
- [ ] 개발자 가이드 보완

---

### 10. 번들 크기 최적화

**예상 시간**: 2-4시간  
**중요도**: ⭐⭐

**작업 내용**:

- [ ] Tree shaking 최적화
- [ ] 사용하지 않는 라이브러리 제거
- [ ] 큰 라이브러리 lazy loading
- [ ] 이미지 최적화 (`next/image` 사용 확대)

---

### 11. 접근성 개선

**예상 시간**: 2-3일  
**중요도**: ⭐⭐

**작업 내용**:

- [ ] 모든 인터랙티브 요소에 ARIA 라벨 추가
- [ ] 키보드 네비게이션 개선
- [ ] 포커스 관리 개선
- [ ] 키보드 단축키 문서화
- [ ] 스크린 리더 테스트

---

### 12. E2E 테스트 확대

**예상 시간**: 1주  
**중요도**: ⭐⭐

**작업 내용**:

- [ ] 주요 사용자 플로우 테스트 추가
- [ ] Playwright 설정 최적화
- [ ] CI/CD 파이프라인에 E2E 테스트 통합

---

## 📝 기술 부채

### 13. 긴 함수/컴포넌트 리팩토링

**예상 시간**: 1주  
**중요도**: ⭐

**작업 내용**:

- [ ] 일부 긴 함수와 컴포넌트를 더 작은 단위로 분리
- [ ] 복잡도 감소

---

### 14. DB 인덱스 최적화 (선택사항)

**예상 시간**: 1-2일  
**중요도**: ⭐

**작업 내용**:

- [ ] Serial # 검색을 위한 복합 인덱스 생성
- [ ] 캘린더 검색을 위한 trigram/tsvector 인덱스 생성
- [ ] 성능 테스트 및 최적화

---

## 🎯 권장 작업 순서

### Phase 1: 보안 강화 (프로덕션 전 필수)

1. 인증/인가 강화 (3-5일) ⚠️ **최우선**

### Phase 2: 품질 개선

2. 테스트 커버리지 향상 (1-2주)
3. 타입 안정성 개선 (3-5일)

### Phase 3: UX/기능 개선

4. 기능 중복 해결 (2-3일)
5. Contact Log 기능 확장 (2-3일)
6. UX Quick Wins (1-2일)
7. SaleForm 개선 (1-2시간)

### Phase 4: 성능 최적화

8. 성능 최적화 (2-4일)

### Phase 5: 문서화 및 부가 기능

9. 문서화 개선 (3-4일)
10. 번들 크기 최적화 (2-4시간)
11. 접근성 개선 (2-3일)
12. E2E 테스트 확대 (1주)

---

## 📊 우선순위 매트릭스

| 작업             | 중요도     | 긴급도     | 예상 시간 | 효과     |
| ---------------- | ---------- | ---------- | --------- | -------- |
| 인증/인가 강화   | ⭐⭐⭐⭐⭐ | ⭐⭐⭐⭐⭐ | 3-5일     | 보안     |
| 테스트 커버리지  | ⭐⭐⭐⭐   | ⭐⭐⭐     | 1-2주     | 품질     |
| 타입 안정성      | ⭐⭐⭐⭐   | ⭐⭐⭐     | 3-5일     | 품질     |
| 기능 중복 해결   | ⭐⭐⭐⭐   | ⭐⭐       | 2-3일     | UX       |
| Contact Log 확장 | ⭐⭐⭐     | ⭐⭐       | 2-3일     | 기능     |
| 성능 최적화      | ⭐⭐⭐     | ⭐⭐       | 2-4일     | 성능     |
| UX Quick Wins    | ⭐⭐⭐     | ⭐⭐       | 1-2일     | UX       |
| 문서화           | ⭐⭐       | ⭐         | 3-4일     | 유지보수 |

---

## 💡 Quick Wins (빠르게 개선 가능)

1. **로그인 페이지 "LATEST" 제거** (30분)
2. **SaleForm 최근 거래 클라이언트 우선 표시** (1-2시간)
3. **빈 상태 처리 일관성** (2-3시간)
4. **`any` 타입 일부 제거** (2-3시간)

---

## 📌 참고 문서

- `docs/TODO_LIST.md` - 상세 TODO 리스트
- `docs/PROJECT_CRITIQUE.md` - 프로젝트 전체 분석
- `docs/PERFORMANCE_ANALYSIS.md` - 성능 분석
- `docs/REMAINING_TASKS_SUMMARY.md` - 남은 작업 요약
- `PRODUCTION_CHECKLIST.md` - 프로덕션 배포 체크리스트
