async function patchHandler(request: NextRequest, _user: User) {
  void _user;

  return apiHandler(
    request,
    {
      method: 'PATCH',
      path: '/api/clients',
      context: 'ClientsAPI',
    },
    async () => {
      const body = await request.json();
      const { id, ...updates } = body;

      if (!id) {
        return {
          data: { error: 'Client ID is required' },
          status: 400,
        };
      }

      // Validate UUID format
      if (!validateUUID(id)) {
        return {
          data: { error: 'Invalid client ID format' },
          status: 400,
        };
      }

      // Validate update data using partial schema
      const validationResult = safeValidate(updates, validatePartialClient);
      if (!validationResult.success) {
        return {
          data: { error: `Invalid update data: ${validationResult.error}` },
          status: 400,
        };
      }

      const supabase = getServerSupabase();
      const { data, error } = await supabase
        .from('clients')
        .update(updates)
        .eq('id', id)
        .select()
        .single();

      if (error) {
        throw errorHandler.handleSupabaseError(error, 'Update client');
      }

      // Validate response data
      const validatedData = validateClient(data);

      return {
        data: validatedData,
        metadata: { clientId: id },
      };
    }
  );
}
